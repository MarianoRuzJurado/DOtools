<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Violin Graph with wilcox test on single cell level — DO.VlnPlot • DOtools</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Violin Graph with wilcox test on single cell level — DO.VlnPlot"><meta name="description" content="Creates a violin plot to compare gene expression across different conditions or groups within a Seurat object.
It incorporates Wilcoxon rank-sum tests to evaluate statistical differences between conditions.
The plot can be customized with options for data transformation, jitter display, and significance annotations.
The function also supports multiple conditions and allows for visualisation of statistical results from wilcoxon test."><meta property="og:description" content="Creates a violin plot to compare gene expression across different conditions or groups within a Seurat object.
It incorporates Wilcoxon rank-sum tests to evaluate statistical differences between conditions.
The plot can be customized with options for data transformation, jitter display, and significance annotations.
The function also supports multiple conditions and allows for visualisation of statistical results from wilcoxon test."><script defer data-domain="pkgdown.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DOtools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.99.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/DOtools.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MarianoRuzJurado/DOtools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Violin Graph with wilcox test on single cell level</h1>
      <small class="dont-index">Source: <a href="https://github.com/MarianoRuzJurado/DOtools/blob/HEAD/R/DO.VlnPlot.R" class="external-link"><code>R/DO.VlnPlot.R</code></a></small>
      <div class="d-none name"><code>DO.VlnPlot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates a violin plot to compare gene expression across different conditions or groups within a Seurat object.
It incorporates Wilcoxon rank-sum tests to evaluate statistical differences between conditions.
The plot can be customized with options for data transformation, jitter display, and significance annotations.
The function also supports multiple conditions and allows for visualisation of statistical results from wilcoxon test.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">DO.VlnPlot</span><span class="op">(</span></span>
<span>  <span class="va">sce_object</span>,</span>
<span>  SeuV5 <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">Feature</span>,</span>
<span>  ListTest <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  returnValues <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ctrl.condition <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group.by <span class="op">=</span> <span class="st">"condition"</span>,</span>
<span>  group.by.2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  geom_jitter_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span><span class="op">)</span>,</span>
<span>  geom_jitter_args_group_by2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  vector_colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#1f77b4"</span>, <span class="st">"#ea7e1eff"</span>, <span class="st">"royalblue4"</span>, <span class="st">"tomato2"</span>, <span class="st">"darkgoldenrod"</span>,</span>
<span>    <span class="st">"palegreen4"</span>, <span class="st">"maroon"</span>, <span class="st">"thistle3"</span><span class="op">)</span>,</span>
<span>  wilcox_test <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  stat_pos_mod <span class="op">=</span> <span class="fl">1.15</span>,</span>
<span>  hjust.wilcox <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  vjust.wilcox <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  size.wilcox <span class="op">=</span> <span class="fl">3.33</span>,</span>
<span>  step_mod <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  hjust.wilcox.2 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  vjust.wilcox.2 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  sign_bar <span class="op">=</span> <span class="fl">0.8</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-sce-object">sce_object<a class="anchor" aria-label="anchor" href="#arg-sce-object"></a></dt>
<dd><p>combined SCE object or Seurat</p></dd>


<dt id="arg-seuv-">SeuV5<a class="anchor" aria-label="anchor" href="#arg-seuv-"></a></dt>
<dd><p>Seuratv5 object? (TRUE or FALSE)</p></dd>


<dt id="arg-feature">Feature<a class="anchor" aria-label="anchor" href="#arg-feature"></a></dt>
<dd><p>name of the feature</p></dd>


<dt id="arg-listtest">ListTest<a class="anchor" aria-label="anchor" href="#arg-listtest"></a></dt>
<dd><p>List for which conditions wilcox will be performed, if NULL always CTRL group against everything</p></dd>


<dt id="arg-returnvalues">returnValues<a class="anchor" aria-label="anchor" href="#arg-returnvalues"></a></dt>
<dd><p>return df.melt.sum data frame containing means and SEM for the set group</p></dd>


<dt id="arg-ctrl-condition">ctrl.condition<a class="anchor" aria-label="anchor" href="#arg-ctrl-condition"></a></dt>
<dd><p>set your ctrl condition, relevant if running with empty comparison List</p></dd>


<dt id="arg-group-by">group.by<a class="anchor" aria-label="anchor" href="#arg-group-by"></a></dt>
<dd><p>select the seurat sce_object slot where your conditions can be found, default conditon</p></dd>


<dt id="arg-group-by-">group.by.2<a class="anchor" aria-label="anchor" href="#arg-group-by-"></a></dt>
<dd><p>relevant for multiple group testing, e.g. for each cell type the test between each of them in two conditions provided</p></dd>


<dt id="arg-geom-jitter-args">geom_jitter_args<a class="anchor" aria-label="anchor" href="#arg-geom-jitter-args"></a></dt>
<dd><p>vector for dots visualisation in vlnplot: size, width, alpha value</p></dd>


<dt id="arg-geom-jitter-args-group-by-">geom_jitter_args_group_by2<a class="anchor" aria-label="anchor" href="#arg-geom-jitter-args-group-by-"></a></dt>
<dd><p>controls the jittering of points if group.by.2 is specified</p></dd>


<dt id="arg-vector-colors">vector_colors<a class="anchor" aria-label="anchor" href="#arg-vector-colors"></a></dt>
<dd><p>specify a minimum number of colours as you have entries in your condition, default 2</p></dd>


<dt id="arg-wilcox-test">wilcox_test<a class="anchor" aria-label="anchor" href="#arg-wilcox-test"></a></dt>
<dd><p>Bolean if TRUE a bonferoni wilcoxon test will be carried out between ctrl.condition and the rest</p></dd>


<dt id="arg-stat-pos-mod">stat_pos_mod<a class="anchor" aria-label="anchor" href="#arg-stat-pos-mod"></a></dt>
<dd><p>value for modifiyng statistics height</p></dd>


<dt id="arg-hjust-wilcox">hjust.wilcox<a class="anchor" aria-label="anchor" href="#arg-hjust-wilcox"></a></dt>
<dd><p>value for adjusting height of the text</p></dd>


<dt id="arg-vjust-wilcox">vjust.wilcox<a class="anchor" aria-label="anchor" href="#arg-vjust-wilcox"></a></dt>
<dd><p>value for vertical of text</p></dd>


<dt id="arg-size-wilcox">size.wilcox<a class="anchor" aria-label="anchor" href="#arg-size-wilcox"></a></dt>
<dd><p>value for size of text of statistical test</p></dd>


<dt id="arg-step-mod">step_mod<a class="anchor" aria-label="anchor" href="#arg-step-mod"></a></dt>
<dd><p>value for defining the space between one test and the next one</p></dd>


<dt id="arg-hjust-wilcox-">hjust.wilcox.2<a class="anchor" aria-label="anchor" href="#arg-hjust-wilcox-"></a></dt>
<dd><p>value for adjusting height of the text, with group.by.2 specified</p></dd>


<dt id="arg-vjust-wilcox-">vjust.wilcox.2<a class="anchor" aria-label="anchor" href="#arg-vjust-wilcox-"></a></dt>
<dd><p>value for vertical of text, with group.by.2 specified</p></dd>


<dt id="arg-sign-bar">sign_bar<a class="anchor" aria-label="anchor" href="#arg-sign-bar"></a></dt>
<dd><p>adjusts the sign_bar with group.by.2 specified</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a ggplot or a list used data frames</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Mariano Ruz Jurado</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">sce_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"sce_data.rds"</span>, package <span class="op">=</span> <span class="st">"DOtools"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ListTest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ListTest</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"healthy"</span>, <span class="st">"disease"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">DO.VlnPlot</span><span class="op">(</span></span></span>
<span class="r-in"><span>  sce_object <span class="op">=</span> <span class="va">sce_data</span>,</span></span>
<span class="r-in"><span>  SeuV5<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  Feature <span class="op">=</span> <span class="st">"NKG7"</span>,</span></span>
<span class="r-in"><span>  ListTest <span class="op">=</span> <span class="va">ListTest</span>,</span></span>
<span class="r-in"><span>  ctrl.condition <span class="op">=</span> <span class="st">"healthy"</span>,</span></span>
<span class="r-in"><span>  group.by<span class="op">=</span><span class="st">"condition"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>SeuV5 is TRUE, if working with Seuratv4 or below change SeuV5 to FALSE</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #555555;">This warning is displayed once per session.</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using group, orig.ident as id variables</span>
<span class="r-plt img"><img src="DO.VlnPlot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mariano Ruz Jurado, David Rodriguez Morales, David John, DFG SFB 1366, Project B04, DFG SFB 1531, Project 456687919.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

